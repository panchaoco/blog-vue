webpackJsonp([2],{"5Jjs":function(t,e,i){"use strict";var r=("getplaysongvkey"+Math.random()).replace("0.","");e.a=r},Loli:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i("mvHQ"),n=i.n(r),a=i("Dd8w"),o=i.n(a),s=i("NYxO"),c=i("xrTZ"),l=i("rBD4"),u=i("Y7xE"),d=i("5Jjs"),p={name:"MusicPlay",data:function(){return{pic:"",begin:!1,hide:!1,show:!1,beginTime:0,endTime:0,currentPlay:0,lyricArr:[],params:{guid:Object(u.a)(),songmid:[],songtype:[0],uin:"0",loginflag:1,platform:"20"},playGetData:{req:{module:"CDN.SrfCdnDispatchServer",method:"GetCdnDispatch",param:{guid:Object(u.a)(),calltype:0,userip:""}},req_0:{module:"vkey.GetVkeyServer",method:"CgiGetVkey",param:this.params},comm:{uin:0,format:"json",ct:24,cv:0}},playList:JSON.parse(window.localStorage.getItem("playList")),playUrl:"",audio:null,openList:!1,bgRgb:null,currentLyric:0,top:0,lyricTimer:null,playing:!1,swiperOption:{direction:"vertical",slidesPerView:"auto",freeMode:!1,scrollbar:{el:".swiper-scrollbar"},mousewheel:!0},pointOpt:{isDown:!1,startX:0,endX:0,oldWidth:0},initPage:!1}},computed:o()({},Object(s.c)({musicOpt:function(t){return t.music.musicOpt}})),created:function(){this.rgbStyle()},mounted:function(){var t=this;this.$nextTick(function(){t.init(!1),window.addEventListener("storage",function(e){"playList"===e.key&&e.newValue!==e.oldValue&&(clearTimeout(t.lyricTimer),t.lyricTimer=null,t.top=0,t.playList=JSON.parse(e.newValue),t.currentPlay=0,t.init(!0),t.rgbStyle())},!1)}),window.addEventListener("beforeunload",function(e){return t.beforeUnloadHandler(e)}),window.localStorage.setItem("isOpen","1"),window.localStorage.setItem("initPage",this.initPage)},methods:o()({},Object(s.b)({updateSongUrl:"music/updateSongUrl",updatePlayStatus:"music/updatePlayStatus",updateMusicPic:"music/updateMusicPic",updateMusicAlbumMid:"music/updateMusicAlbumMid"}),{beforeUnloadHandler:function(t){window.localStorage.setItem("isOpen","0")},init:function(){this.top=0,this.currentLyric=0,this.beginTime=0,this.rgbStyle(),this.getAlbum(),this.getPlayUrl()},getAlbum:function(){var t=this,e=l.a.getACSRFToken(),i=this.playList[this.currentPlay].albummid;this.$store.dispatch("music/getMusicAlbum",{ct:24,g_tk:e,albummid:i}).then(function(e){0===e.code&&(t.pic="https://y.gtimg.cn/music/photo_new/T002R300x300M000"+e.data.mid+".jpg?max_age="+Math.ceil(3e6*Math.random()),t.updatePlayStatus(!0))})},getLyric:function(){var t=this,e=l.a.getACSRFToken();this.playList&&this.playList.length>0&&this.$store.dispatch("music/getMusicLyric",{"-":"MusicJsonCallback_lrc",pcachetime:(new Date).valueOf(),songmid:this.playList[this.currentPlay].songmid,g_tk:e}).then(function(e){0===e.code&&(t.lyricArr=[],c.Base64.decode(e.lyric).split(/\n/).forEach(function(e){var i=/\[\d{2}.*\]/g,r=e.match(i);r&&e.split(i)[1]&&t.lyricArr.push({time:r[0].replace("[","").replace("]","").split(".")[0],text:e.split(i)[1]})}))})},getPlayUrl:function(){var t=this;this.$set(this.params,"songmid",[this.playList[this.currentPlay].songmid]),this.$set(this.params,"songtype",[this.playList[this.currentPlay].songtype]),this.playGetData.req_0.param=this.params,this.$store.dispatch("music/getMusicPlayUrl",{"-":d.a,g_tk:l.a.getACSRFToken(),loginUin:0,hostUin:0,format:"json",inCharset:"utf8",outCharset:"utf-8",notice:0,platform:"yqq.json",needNewCode:0,data:n()(this.playGetData)}).then(function(e){var i=e.req_0.data,r=e.req.data,n=t.playList[t.currentPlay],a=r.freeflowsip&&r.freeflowsip.length>0?r.freeflowsip[0]:i.sip[0];n.play=!n.play;var o=[];if(i.midurlinfo.length>0){var s=i.midurlinfo[0].purl?i.midurlinfo[0].purl:i.testfile2g;o=[""+a+s]}r.sip.forEach(function(t){o.push(""+t+r.testfile2g+"&r="+Math.random().toString().replace("0.",""))}),t.playUrl=o,t.getLyric()})},togglePlayStatus:function(t,e){this.$refs.border.style.animationPlayState=e,t!==this.currentPlay?(this.currentPlay=t,window.localStorage.setItem("initPage","true"),this.init()):(this.playing=!this.playing,this.playing?this.play():this.pause())},currentPlayTime:function(){var t=this;clearTimeout(this.lyricTimer),this.lyricTimer=null,this.lyricTimer=setTimeout(function(){t.beginTime=parseInt(t.audio.currentTime),t.beginTime<=t.endTime&&(t.scrollLyric(),t.currentPlayTime(),t.computedPrograms())},1e3)},scrollLyric:function(){if(this.lyricArr.length>0){for(var t=0;t<this.lyricArr.length;t++)if(t<this.lyricArr.length-1){var e=this.lyricArr[t].time.split(":"),i=this.lyricArr[t+1].time.split(":");this.beginTime>=parseInt(60*e[0])+parseInt(e[1])&&this.beginTime<=parseInt(60*i[0])+parseInt(i[1])&&(this.currentLyric=t)}if(this.currentPlay===this.lyricArr.length-2){var r=this.lyricArr[this.lyricArr.length-1].time.split(":");this.beginTime>=parseInt(60*r[0])+parseInt(r[1])&&(this.currentLyric=this.lyricArr.length-1)}}},play:function(){this.audio.controls=!0;try{this.audio.play(),this.audio.controls=!1,this.playing=!0,this.endTime=parseInt(this.audio.duration),this.begin=!0,this.currentPlayTime()}catch(t){}},pause:function(){this.audio.pause(),this.playing=!1,clearTimeout(this.lyricTimer),this.lyricTimer=null},prevMusic:function(){this.currentPlay>0?this.currentPlay-=1:this.currentPlay=this.playList.length-1,window.localStorage.setItem("initPage","true"),this.init()},nextMusic:function(){window.localStorage.setItem("initPage","true"),this.onEnded()},rgbStyle:function(){var t=Math.ceil(255*Math.random()),e=Math.ceil(255*Math.random()),i=Math.ceil(255*Math.random());t=t<100?100:t,e=e<120?140:e,i=i<150?166:i,this.border="rgba("+(t+20)+", "+e+", "+(i+30)+", 0.2)",this.bgRgb={background:"linear-gradient(to right, rgba("+(t+20)+", "+e+", "+(i+40)+", 1), rgba("+(t+10)+", "+(e-40)+", "+(i+30)+", 1), rgba("+(t+30)+", "+e+", "+(i+50)+", 1))"}},onEnded:function(){this.currentPlay<this.playList.length-1?this.currentPlay+=1:this.currentPlay=0,this.init()},canPlay:function(t){var e=this;this.audio=t.target,setTimeout(function(){e.play()},500)},onPlayList:function(){this.openList=!this.openList},handleMusicTime:function(t){var e=Math.floor(t/60);return"0"+e+":"+(t-60*e<10?"0"+(t-60*e):t-60*e)},computedPrograms:function(){if(this.$refs.line){var t=this.$refs.line.getBoundingClientRect().width,e=this.audio.currentTime*t/this.audio.duration;this.$refs.currentLine.style.width=e+"px"}},pointDown:function(t){var e=this;this.pointOpt.isDown=!0,this.pointOpt.startX=t.clientX,this.pointOpt.oldWidth=parseInt(window.getComputedStyle(this.$refs.currentLine,null).getPropertyValue("width")),document.body.addEventListener("mousemove",this.pointMove,!1),document.body.addEventListener("mouseup",function(t){document.body.removeEventListener("mousemove",e.pointMove,!1),e.pointUp(t)})},pointMove:function(t){if(this.pointOpt.isDown){this.pointOpt.endX=t.clientX;var e=this.pointOpt.endX-this.pointOpt.startX,i=this.pointOpt.oldWidth+e;this.$refs.currentLine.style.width=i+"px"}},pointUp:function(t){this.pointOpt.isDown=!1,this.pointOpt.endX=t.clientX;var e=parseInt(window.getComputedStyle(this.$refs.currentLine,null).getPropertyValue("width"));this.audio.currentTime=e*this.audio.duration/parseInt(window.getComputedStyle(this.$refs.line,null).getPropertyValue("width")),this.play(),clearTimeout(this.lyricTimer),this.lyricTimer=null},setTimePlay:function(t){var e=t.offsetX;this.$refs.currentLine.style.width=e+"px",this.audio.currentTime=e*this.audio.duration/parseInt(window.getComputedStyle(this.$refs.line,null).getPropertyValue("width"))}}),destroyed:function(){var t=this;window.removeEventListener("beforeunload",function(e){return t.beforeUnloadHandler(e)})},watch:{currentLyric:function(t,e){t!==e&&t>=7&&this.lyricArr.length-8>=t?this.top=-30*(t-7):t>this.lyricArr.length-8&&t-e>1&&(this.top=-30*(t-7))}}},h={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{staticClass:"music-play-container"},[i("div",{staticClass:"music-pic-wrapper"},[i("div",{staticClass:"music-info"},[i("div",{staticClass:"play-list"},[t._m(0),t._v(" "),i("div",{staticClass:"scroll"},[i("swiper",{attrs:{options:t.swiperOption}},[i("swiper-slide",{staticClass:"text"},[i("ul",{staticClass:"list content"},t._l(t.playList,function(e,r){return i("li",{key:r,style:{borderBottom:"1px solid "+t.border}},[i("div",{staticClass:"info",class:{curr:r===t.currentPlay}},[i("span",[t._v(t._s(e.songname))]),t._v(" "),i("i",{staticStyle:{margin:"0 6px"}},[t._v("-")]),t._v(" "),t._l(e.singer,function(r,n){return i("p",{key:r.id,staticClass:"single"},[i("span",[t._v(t._s(r.name))]),t._v(" "),i("span",{staticStyle:{margin:"0 6px"}},[t._v(t._s(n!==e.singer.length-1?"-":""))])])})],2),t._v(" "),i("div",{staticClass:"play-status",attrs:{title:"播放"}},[r===t.currentPlay&&t.playing&&-1!==t.playing?i("Icon",{ref:"playIcon",refInFor:!0,attrs:{type:"md-pause"},on:{click:function(e){t.togglePlayStatus(r,"paused")}}}):i("Icon",{ref:"playIcon",refInFor:!0,attrs:{type:"md-play"},on:{click:function(e){t.togglePlayStatus(r,"running")}}})],1),t._v(" "),i("div",{staticClass:"dynamic",class:{playing:r===t.currentPlay}},[i("span"),t._v(" "),i("span"),t._v(" "),i("span"),t._v(" "),i("span")]),t._v(" "),i("div",{staticClass:"remove",attrs:{title:"删除"}},[i("Icon",{attrs:{type:"md-trash"}})],1)])}),0)]),t._v(" "),i("div",{staticClass:"swiper-scrollbar",attrs:{slot:"scrollbar"},slot:"scrollbar"},[i("div",{staticClass:"swiper-scrollbar-drag",style:{backgroundColor:t.border}})])],1)],1)]),t._v(" "),i("div",{staticClass:"music"},[i("div",{ref:"border",staticClass:"pic-border",class:{begin:t.begin,hidden:t.hide}},[i("img",{attrs:{src:t.pic,alt:""}})]),t._v(" "),i("div",{staticClass:"lyric-wrapper"},[i("div",{staticClass:"lyric",style:{transform:"translateY("+t.top+"px)"}},t._l(t.lyricArr,function(e,r){return i("p",{key:r,ref:"lyric",refInFor:!0,class:{active:t.currentLyric===r}},[t._v("\n              "+t._s(e.text))])}),0)])])]),t._v(" "),i("div",{staticClass:"programs"},[i("div",{staticClass:"profile-wrapper"},[i("Icon",{staticClass:"comm",attrs:{type:"md-skip-backward"},on:{click:t.prevMusic}}),t._v(" "),t.playing&&-1!==t.playing?i("Icon",{ref:"playIcon",staticClass:"comm",attrs:{type:"md-pause"},on:{click:function(e){t.togglePlayStatus(t.currentPlay,"paused")}}}):i("Icon",{ref:"playIcon",staticClass:"comm",attrs:{type:"md-play"},on:{click:function(e){t.togglePlayStatus(t.currentPlay,"running")}}}),t._v(" "),i("Icon",{staticClass:"comm",attrs:{type:"md-skip-forward"},on:{click:t.nextMusic}})],1),t._v(" "),i("span",{staticClass:"begin-time"},[t._v(t._s(t.handleMusicTime(t.beginTime)))]),t._v(" "),i("div",{ref:"line",staticClass:"line",on:{click:t.setTimePlay}},[i("div",{ref:"currentLine",staticClass:"current-line"},[i("span",{ref:"point",staticClass:"point",on:{mousedown:t.pointDown}})])]),t._v(" "),i("span",{staticClass:"duration"},[t._v(t._s(t.handleMusicTime(t.endTime)))]),t._v(" "),i("div",{staticClass:"play-list-icon",on:{click:t.onPlayList}},[i("Icon",{attrs:{type:"md-reorder"}})],1)])]),t._v(" "),t.playUrl.length>0?i("audio",{ref:"audio",staticClass:"audio",attrs:{width:"0",height:"0",src:t.playUrl[0],muted:""},on:{canplay:t.canPlay,ended:t.onEnded}},t._l(t.playUrl,function(t,e){return i("source",{key:e,attrs:{src:t}})}),0):t._e(),t._v(" "),i("div",{staticClass:"player-img",style:{backgroundImage:"url("+t.pic+")"}})])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("ul",{staticClass:"top"},[e("li",[e("div",{staticClass:"title"},[this._v("歌曲信息")]),this._v(" "),e("div",{staticClass:"profile"},[this._v("操作")]),this._v(" "),e("div",{staticClass:"status"},[this._v("状态")]),this._v(" "),e("div",{staticClass:"del"},[this._v("删除")])])])}]};var f=i("VU/8")(p,h,!1,function(t){i("RQOe")},"data-v-72420792",null);e.default=f.exports},RQOe:function(t,e){},Y7xE:function(t,e,i){"use strict";(function(t){var r=i("rBD4");t._guid="";e.a=function(){if(t._guid.length>0)return t._guid;var e=r.a.get("pgv_pvid");if(e&&e.length>0)return t._guid=e;console.log("pgv_pvid",e);var i=(new Date).getUTCMilliseconds();return t._guid=Math.round(2147483647*Math.random())*i%1e10,document.cookie="pgv_pvid="+t._guid+"; Expires=Sun, 18 Jan 2038 00:00:00 GMT; PATH=/;",t._guid}}).call(e,i("DuR2"))},rBD4:function(t,e,i){"use strict";var r="y.qq.com",n="/";e.a={set:function(t,e,i,n,a){var o="";return a&&(o=new Date).setTime(o.getTime()+36e5*a),document.cookie=t+"="+escape(e)+"; "+(a?"expires="+o.toGMTString()+"; ":"")+(n?"path="+n+"; ":"path=/; ")+(i?"domain="+i+";":"domain="+r+";"),!0},get:function(t){var e;return function(t){if(!t)return t;for(;t!=unescape(t);)t=unescape(t);for(var e=["<",">","'",'"',"%3c","%3e","%27","%22","%253c","%253e","%2527","%2522"],i=["&#x3c;","&#x3e;","&#x27;","&#x22;","%26%23x3c%3B","%26%23x3e%3B","%26%23x27%3B","%26%23x22%3B","%2526%2523x3c%253B","%2526%2523x3e%253B","%2526%2523x27%253B","%2526%2523x22%253B"],r=0;r<e.length;r++)t=t.replace(new RegExp(e[r],"gi"),i[r]);return t}((e=document.cookie.match(RegExp("(^|;\\s*)"+t+"=([^;]*)(;|$)")))?unescape(e[2]):"")},del:function(t,e,i){document.cookie=t+"=; expires=Mon, 26 Jul 1997 05:00:00 GMT; "+(i?"path="+i+"; ":"path=/; ")+(e?"domain="+e+";":"domain="+n+";")},getACSRFToken:function(){return function(t){for(var e=5381,i=0,r=t.length;r>i;++i)e+=(e<<5)+t.charCodeAt(i);return 2147483647&e}(this.get("p_skey")||this.get("skey")||this.get("p_lskey")||this.get("lskey"))}}},xrTZ:function(module,exports,__webpack_require__){(function(global){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;!function(t,e){module.exports=e(t)}("undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==global?global:this,function(global){"use strict";global=global||{};var _Base64=global.Base64,version="2.5.1",buffer;if(void 0!==module&&module.exports)try{buffer=eval("require('buffer').Buffer")}catch(t){buffer=void 0}var b64chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b64tab=function(t){for(var e={},i=0,r=t.length;i<r;i++)e[t.charAt(i)]=i;return e}(b64chars),fromCharCode=String.fromCharCode,cb_utob=function(t){if(t.length<2)return(e=t.charCodeAt(0))<128?t:e<2048?fromCharCode(192|e>>>6)+fromCharCode(128|63&e):fromCharCode(224|e>>>12&15)+fromCharCode(128|e>>>6&63)+fromCharCode(128|63&e);var e=65536+1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320);return fromCharCode(240|e>>>18&7)+fromCharCode(128|e>>>12&63)+fromCharCode(128|e>>>6&63)+fromCharCode(128|63&e)},re_utob=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,utob=function(t){return t.replace(re_utob,cb_utob)},cb_encode=function(t){var e=[0,2,1][t.length%3],i=t.charCodeAt(0)<<16|(t.length>1?t.charCodeAt(1):0)<<8|(t.length>2?t.charCodeAt(2):0);return[b64chars.charAt(i>>>18),b64chars.charAt(i>>>12&63),e>=2?"=":b64chars.charAt(i>>>6&63),e>=1?"=":b64chars.charAt(63&i)].join("")},btoa=global.btoa?function(t){return global.btoa(t)}:function(t){return t.replace(/[\s\S]{1,3}/g,cb_encode)},_encode=buffer?buffer.from&&Uint8Array&&buffer.from!==Uint8Array.from?function(t){return(t.constructor===buffer.constructor?t:buffer.from(t)).toString("base64")}:function(t){return(t.constructor===buffer.constructor?t:new buffer(t)).toString("base64")}:function(t){return btoa(utob(t))},encode=function(t,e){return e?_encode(String(t)).replace(/[+\/]/g,function(t){return"+"==t?"-":"_"}).replace(/=/g,""):_encode(String(t))},encodeURI=function(t){return encode(t,!0)},re_btou=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}","[ð-÷][-¿]{3}"].join("|"),"g"),cb_btou=function(t){switch(t.length){case 4:var e=((7&t.charCodeAt(0))<<18|(63&t.charCodeAt(1))<<12|(63&t.charCodeAt(2))<<6|63&t.charCodeAt(3))-65536;return fromCharCode(55296+(e>>>10))+fromCharCode(56320+(1023&e));case 3:return fromCharCode((15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2));default:return fromCharCode((31&t.charCodeAt(0))<<6|63&t.charCodeAt(1))}},btou=function(t){return t.replace(re_btou,cb_btou)},cb_decode=function(t){var e=t.length,i=e%4,r=(e>0?b64tab[t.charAt(0)]<<18:0)|(e>1?b64tab[t.charAt(1)]<<12:0)|(e>2?b64tab[t.charAt(2)]<<6:0)|(e>3?b64tab[t.charAt(3)]:0),n=[fromCharCode(r>>>16),fromCharCode(r>>>8&255),fromCharCode(255&r)];return n.length-=[0,0,2,1][i],n.join("")},_atob=global.atob?function(t){return global.atob(t)}:function(t){return t.replace(/\S{1,4}/g,cb_decode)},atob=function(t){return _atob(String(t).replace(/[^A-Za-z0-9\+\/]/g,""))},_decode=buffer?buffer.from&&Uint8Array&&buffer.from!==Uint8Array.from?function(t){return(t.constructor===buffer.constructor?t:buffer.from(t,"base64")).toString()}:function(t){return(t.constructor===buffer.constructor?t:new buffer(t,"base64")).toString()}:function(t){return btou(_atob(t))},decode=function(t){return _decode(String(t).replace(/[-_]/g,function(t){return"-"==t?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))},noConflict=function(){var t=global.Base64;return global.Base64=_Base64,t};if(global.Base64={VERSION:version,atob:atob,btoa:btoa,fromBase64:decode,toBase64:encode,utob:utob,encode:encode,encodeURI:encodeURI,btou:btou,decode:decode,noConflict:noConflict,__buffer__:buffer},"function"==typeof Object.defineProperty){var noEnum=function(t){return{value:t,enumerable:!1,writable:!0,configurable:!0}};global.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",noEnum(function(){return decode(this)})),Object.defineProperty(String.prototype,"toBase64",noEnum(function(t){return encode(this,t)})),Object.defineProperty(String.prototype,"toBase64URI",noEnum(function(){return encode(this,!0)}))}}return global.Meteor&&(Base64=global.Base64),void 0!==module&&module.exports?module.exports.Base64=global.Base64:(__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=function(){return global.Base64}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),void 0===__WEBPACK_AMD_DEFINE_RESULT__||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)),{Base64:global.Base64}})}).call(exports,__webpack_require__("DuR2"))}});